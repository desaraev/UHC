typeof $scw=="undefined"&&(window.$scw=jQuery.noConflict(!0));$scw.validator.addMethod("multiregex",function(n,t,i){var r;return this.optional(t)?!0:(r=new RegExp(i.mpattern).exec(n),r&&r.index===0&&r[0].length===n.length)});$scw.validator.unobtrusive.adapters.add("multiregex",["pattern"],function(n){var t={mpattern:n.params.pattern};n.rules.multiregex=t;n.messages.multiregex=n.message});typeof $scw=="undefined"&&(window.$scw=jQuery.noConflict(!0));$scw.widget("wffm.eventTracking",{options:{formId:null,pageId:null,fieldId:null,fieldTitle:null,fieldValue:null,eventCount:null,rules:null},_create:function(){var n=this,t=this.options,i;t.eventCount=0;i=$scw(this.element).attr("id");t.formId=$scw(this.element).children("input[name='"+i+".FormId']").val();this.element.find("input[type!='submit'], select, textarea").bind("focus",function(t){n.onFocusField(t,this)}).bind("blur change",function(t){n.onBlurField(t,this)})},_getElementName:function(n){var t=n.name,i,r;return this.endsWith(t.toLowerCase(),"value")?t:(i="fields[",r=t.toLowerCase().indexOf(i),t.substring(0,r+i.length+3)+"Value")},_getElementValue:function(n){var t=null,r=[],i;if(n.type=="checkbox"){var u=n.name,f=$scw(n).closest("form"),e="selected";if(this.endsWith(u.toLowerCase(),e)){var o="items[",s=u.toLowerCase().indexOf(o),h=u.substring(0,s+o.length),c=f.find("input[name^='"+h+"']").not(":not(:checked)");$scw.each(c,function(){var i=this.name.slice(0,-e.length)+"Value",n=$scw(this).parent().find("input[name='"+i+"']"),t;n&&(t=n.val(),r.push(t))});t=r}else i=f.find("input[name='"+u+"']"),i.length>1?(i=i.not(":not(:checked)"),$scw.each(i,function(){r.push($scw(this).val())}),t=r):t=n.checked?"1":"0"}else t=$scw(n).val();return t},onFocusField:function(n,t){var i=this._getElementName(t),r=this._getElementValue(t);this.options.fieldId!=i&&(this.options.fieldId=i,this.options.fieldValue=r)},onBlurField:function(n,t){var s=$scw(t).closest("form"),f=s.data("validator"),r=this._getElementName(t),e,i,u,o;if(!this.endsWith(r,"value")){if(e=this._getOwner(s,r),!e)return;t=e}if(i=this._getElementValue(t),this.options.fieldId!=r||this.options.fieldId==r&&this.options.fieldValue!=i){this.options.fieldId=r;this.options.fieldValue=i;u=$scw(t).closest(".field-title")[0];u||(u=this.closestElement(t,"field-title"));o=u[0].innerHTML.replace(/(\r\n|\n|\r)/gm," ").trim();$scw.isArray(i)&&(i=i.join(","));t.type=="password"&&(i="schidden");var c=this._getEvent(r,o,"Field Completed",i.replace(/<schidden>.*<\/schidden>/,"schidden")),h=[],l=f.element(t);f&&!l&&(h=this._checkClientValidation(t,o,f));this._trackEvents($scw.merge([c],h))}},endsWith:function(n,t){return n.toLowerCase().indexOf(t.toLowerCase(),n.length-t.length)!==-1},closestElement:function(n,t){var i=$scw(n).parent(),r=i.find("."+t);return!r[0]&&!i.hasClass("field-border")?this.closestElement(i,t):r},_getOwner:function(n,t){var i=t.slice(0,-(t.length-t.lastIndexOf(".")-1))+"Value";return n.find('input[name="'+i+'"]')[0]},_checkClientValidation:function(n,t,i){var u=this,f=[],r=$scw.parseJSON(u.options.rules.replace(/&quot;/g,'"'));return r||(r={"*":"{844BBD40-91F6-42CE-8823-5EA4D089ECA2}"}),$scw.each(i.errorMap,function(e,o){var h,s,c;e==n.name&&(h=u._selectKey(i.settings.messages[e],o),s=r[h],s||(s=r["*"]),c=u._getEvent(e,t,s,o),f.push(c))}),f},_selectKey:function(n,t){var i;return $scw.each(n,function(n,r){if(t==r)return i=n,!1}),i},_trackEvents:function(n){$scw.ajax({type:"POST",url:"/clientevent/process",data:JSON.stringify(n),dataType:"json",contentType:"application/json"})},_getEvent:function(n,t,i,r){var u=this.options,f;return++u.eventCount,f=n.slice(0,-5)+"FieldId",n=$scw('input[name="'+f+'"]').val(),{FieldID:n,Type:i,Value:r,FieldTitle:t,FormID:u.formId,PageID:u.pageId,Ticks:u.eventCount}}});typeof $scw=="undefined"&&(window.$scw=jQuery.noConflict(!0));$scw.widget("wffm.datebox",{options:{day:null,month:null,year:null},_create:function(){var i=this,t=$scw(this.element).attr("id"),r=t.slice(0,-5),n=this.options;n.day=this.element.parent().children("#"+r+"Day");n.month=this.element.parent().children("#"+r+"Month");n.year=this.element.parent().children("#"+r+"Year");n.day.bind("change",function(n){i.updateDateField(n,this,t)});n.month.bind("change",function(n){i.updateDateField(n,this,t)});n.year.bind("change",function(n){i.updateDateField(n,this,t)})},updateDateField:function(n,t,i){var r,u;if($scw(this.options.month).find("option").length>0&&$scw(this.options.year).find("option").length>0){for(r=this.getDays(this.options.month.val(),this.options.year.val());$scw(this.options.day).find("option").length>r;)u=$scw(this.options.day).find("option"),u[u.length-1].remove();while($scw(this.options.day).find("option").length<r)this.options.day.append($scw("<option/>",{value:$scw(this.options.day).children().length+1,text:$scw(this.options.day).children().length+1}))}this.updateIsoDate(i)},getDays:function(n,t){return new Date(t,n,0).getDate()},updateIsoDate:function(n){var r=this.options.year.val(),t=this.options.month.val(),i=this.options.day.val();t.length==1&&(t="0"+t);i.length==1&&(i="0"+i);$scw("#"+n).val(r+t+i+"T000000")}});typeof $scw=="undefined"&&(window.$scw=jQuery.noConflict(!0));$scw.widget("wffm.captcha",{_create:function(){var n=this;$scw(this.element).find(".selector-field-captcha-play").click(function(t){t.preventDefault();var i=$scw(n.element).find(".field-captcha-audio");i.empty();i.append('<embed id="player" src="'+n.options.handlerUrl+"&nocache="+Date.now()+'" type="audio/x-wav" autostart="true" hidden="true"/>')});$scw(this.element).find(".selector-field-captcha-refresh").click(function(n){n.preventDefault();window.location.reload()})}});typeof $scw=="undefined"&&(window.$scw=jQuery.noConflict(!0));$scw.widget("wffm.ajaxForm",{options:{targetId:null},_create:function(){var n=this.element,t=this.options;n.submit(function(){return $scw(this).valid()&&$scw.ajax({url:this.action,type:this.method,processData:!1,contentType:!1,data:new FormData(n.get(0)),success:function(n){redirectPageUrl=$scw("#redirectPageUrl").val();redirectPageUrl===undefined?$scw("#"+t.targetId).html(n):location.href=redirectPageUrl},error:function(n){$scw("#"+t.targetId).html(n.responseText)}}),!1})}})
